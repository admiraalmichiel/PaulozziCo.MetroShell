<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk" 
    xmlns:System="clr-namespace:System;assembly=mscorlib" 
    xmlns:converters="clr-namespace:PaulozziCo.MetroShell.Presentation.Converters"
    xmlns:primitives="clr-namespace:System.Windows.Controls.Primitives;assembly=System.Windows.Controls" 
    xmlns:framework="clr-namespace:Microsoft.LightSwitch.Presentation.Framework;assembly=Microsoft.LightSwitch.Client"
    xmlns:fxconv="clr-namespace:Microsoft.LightSwitch.Presentation.Framework.Converters.Internal;assembly=Microsoft.LightSwitch.Client"
    xmlns:ctl="clr-namespace:Microsoft.LightSwitch.Presentation.Implementation.Controls;assembly=Microsoft.LightSwitch.Client.Internal"
    xmlns:style="clr-namespace:Microsoft.LightSwitch.Presentation.Framework.Helpers;assembly=Microsoft.LightSwitch.Client"
    xmlns:fm="clr-namespace:Microsoft.LightSwitch.Presentation.Framework;assembly=Microsoft.LightSwitch.Client"
    xmlns:slu="clr-namespace:Microsoft.LightSwitch.SilverlightUtilities.Controls.Internal;assembly=Microsoft.LightSwitch.Client"
    xmlns:internalconverters="clr-namespace:Microsoft.LightSwitch.Presentation.Framework.Converters.Internal;assembly=Microsoft.LightSwitch.Client"    
    xmlns:internalControls="clr-namespace:Microsoft.LightSwitch.SilverlightUtilities.Controls.Internal;assembly=Microsoft.LightSwitch.Client"
    xmlns:utils="clr-namespace:Microsoft.LightSwitch.Presentation.Utilities.Internal;assembly=Microsoft.LightSwitch.Client"
    xmlns:frameworkStyles="clr-namespace:Microsoft.LightSwitch.Presentation.Framework.Helpers;assembly=Microsoft.LightSwitch.Client"
    xmlns:resources="clr-namespace:Microsoft.LightSwitch.Presentation.Implementation.Resources;assembly=Microsoft.LightSwitch.Client.Internal"
    xmlns:visual="clr-namespace:Microsoft.LightSwitch.Presentation.Implementation.Controls;assembly=Microsoft.LightSwitch.Client.Internal"
    mc:Ignorable="d">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/PaulozziCo.MetroShell.Client;component/Presentation/Themes/DataPagerStyle.xaml" />
    </ResourceDictionary.MergedDictionaries>
    
    <ctl:VisibilityToBooleanConverter x:Key="VisibilityToBooleanConverter"/>
    <utils:BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter"/>
    <internalControls:BooleanToVisibleConverter x:Key="BoolToVisibleConverter"/>
    <internalconverters:GrayscaleImageConverter x:Key="GrayscaleConverter"/>
    <converters:TextToLowerConverter x:Key="ToLowerConverter"/>
    <converters:TextToUpperConverter x:Key="ToUpperConverter"/>
	<converters:ExtendedCommandToIconConverter x:Key="IconConverter"/>
    <converters:DefaultCollectionIconConverter x:Key="IconConverter"/>
    <resources:LocalizedStrings x:Key="LocalizedStrings"/>
    <ctl:ContentItemToPropertiesConverter x:Key="_ContentItemToPropertiesConverter"/>
    <ctl:SelectedItemToContentConverter x:Key="_SelectedItemToContentConverter"/>

    <!-- Style for list box items.  Note that this is used primarily in the AutoCompleteBox and sort dropdowns, as the 
         LightSwitch 'List' is really a data grid that is styled to look like a list.-->
    <Style x:Key="ListBoxItemStyle" TargetType="ListBoxItem">
        <Setter Property="Padding" Value="3, 1.5" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Top" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource MenuItemTextBrush}" />
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="TabNavigation" Value="Local" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Grid Background="{TemplateBinding Background}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="CommonStatesRectangle" Storyboard.TargetProperty="Opacity" Duration="0" To="1"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled">
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected" />
                                <VisualState x:Name="Selected">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SelectedRectangle" Storyboard.TargetProperty="Opacity" Duration="0" To="1"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="FocusVisualElement" Storyboard.TargetProperty="Opacity" Duration="0" To="1"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Unfocused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>


                        <Rectangle x:Name="SelectedRectangle" Opacity="0" 
                                   Fill="{StaticResource MenuItemBackgroundSelectedBrush}" 
                                   Stroke="{StaticResource MenuItemBorderSelectedBrush}"
                                   StrokeThickness="1"
                                   />

                        <Rectangle x:Name="CommonStatesRectangle" Opacity="0" 
                                   Fill="{StaticResource MenuItemBackgroundMouseOverBrush}"
                                   Stroke="{StaticResource MenuItemBorderMouseOverBrush}"
                                   StrokeThickness="1"
                                   />

                        <Rectangle x:Name="FocusVisualElement" Opacity="0"
                                   Fill="{StaticResource MenuItemBackgroundMouseOverBrush}"
                                   Stroke="{StaticResource MenuItemBorderMouseOverBrush}" 
                                   StrokeThickness="1"
                                   />

                        <ContentPresenter x:Name="contentPresenter"
                                          Content="{TemplateBinding Content}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"/>

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    
    <!-- Combo box style for the sort dropdown that appears on the list control -->
    <Style x:Key="SortDropDownStyle" TargetType="ComboBox">
        <Setter Property="ItemContainerStyle" Value="{StaticResource ComboBoxItemStyle}"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ListHeaderTextBrush}"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="TabNavigation" Value="Once" />
        <Setter Property="BorderBrush" Value="{StaticResource ListBorderBrush}"/>
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <Grid.Resources>
                            <Style x:Name="comboToggleStyle" TargetType="ToggleButton">
                                <Setter Property="Background" Value="{StaticResource ToolbarBackgroundBrush}"/>
                                <Setter Property="BorderThickness" Value="1"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ToggleButton">
                                            <Grid>
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">
                                                        <VisualState x:Name="Normal"/>
                                                        <VisualState x:Name="MouseOver">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BtnArrow" Storyboard.TargetProperty="Fill" Duration="0">
                                                                    <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextMouseOverBrush}" KeyTime="0"/>
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Pressed">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BtnArrow" Storyboard.TargetProperty="Fill" Duration="0">
                                                                    <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextFocusedBrush}" KeyTime="0"/>
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Disabled" />
                                                    </VisualStateGroup>
                                                    <VisualStateGroup x:Name="CheckStates">
                                                        <VisualState x:Name="Checked">
                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BtnArrow" Storyboard.TargetProperty="Fill" Duration="0">
                                                                    <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextFocusedBrush}" KeyTime="0"/>
                                                                </ObjectAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Unchecked"/>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>

                                                <Rectangle x:Name="BackgroundRectangle" Stretch="Fill" Fill="{TemplateBinding Background}" />

                                                <ContentPresenter
                                                        x:Name="contentPresenter"
                                                        Content="{TemplateBinding Content}"
                                                        ContentTemplate="{TemplateBinding ContentTemplate}"
                                                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                        Visibility="Collapsed"
                                                        Margin="{TemplateBinding Padding}"/>
                                                <Path x:Name="BtnArrow" Margin="2,4,1,0"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      Data="M 1.32501220703125,0.225006103515625 C1.0350341796875,-0.06494140625 0.56494140625,-0.06494140625 0.2750244140625,0.225006103515625 -0.01495361328125,0.51495361328125 -0.01495361328125,0.98504638671875 0.2750244140625,1.274993896484375 0.2750244140625,1.274993896484375 4.4749755859375,5.475006103515625 4.4749755859375,5.475006103515625 4.76495361328125,5.76495361328125 5.23504638671875,5.76495361328125 5.5250244140625,5.475006103515625 5.5250244140625,5.475006103515625 9.7249755859375,1.274993896484375 9.7249755859375,1.274993896484375 10.01495361328125,0.98504638671875 10.01495361328125,0.51495361328125 9.7249755859375,0.225006103515625 9.43505859375,-0.06494140625 8.9649658203125,-0.06494140625 8.67498779296875,0.225006103515625 8.67498779296875,0.225006103515625 5,3.899993896484375 5,3.899993896484375 5,3.899993896484375 1.32501220703125,0.225006103515625 1.32501220703125,0.225006103515625 z" UseLayoutRounding="False" 
                                                      Fill="{TemplateBinding Foreground}"/>
                                                    
                                                <Rectangle Fill="{TemplateBinding BorderBrush}" Height="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom"/>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused"/>
                                <VisualState x:Name="Unfocused"/>
                                <VisualState x:Name="FocusedDropDown">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Duration="00:00:00" Storyboard.TargetName="PopupBorder" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Border x:Name="ContentPresenterBorder"
                                Background="Transparent"
                                Margin="0">
                            <Grid>
                                <ToggleButton x:Name="DropDownToggle" Style="{StaticResource comboToggleStyle}" 
                                              HorizontalContentAlignment="Right" VerticalContentAlignment="Center"
                                              HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                                              Margin="0" Padding="0"
                                              Background="Transparent" 
                                              BorderThickness="{TemplateBinding BorderThickness}" 
                                              BorderBrush="{StaticResource ListHeaderBorderBrush}">
                                    <ToggleButton.Foreground>
                                        <LinearGradientBrush
                                                    StartPoint="0.5,-0.000001342040492045726"
                                                    EndPoint="0.5,1.000001342040492">
                                            <LinearGradientBrush.GradientStops>
                                                <GradientStopCollection>
                                                    <GradientStop Color="#FF31302b" Offset="0" />
                                                    <GradientStop Color="#FFb1a9a6" Offset="0.9888889789581299" />
                                                </GradientStopCollection>
                                            </LinearGradientBrush.GradientStops>
                                        </LinearGradientBrush>
                                    </ToggleButton.Foreground>
                                </ToggleButton>
                            </Grid>
                        </Border>
                        <Popup x:Name="Popup" MinWidth="125">
                            <!-- Extra border to ensure we get the margin space -->
                            <Border
                                x:Name="PopupBorder" HorizontalAlignment="Stretch" Height="Auto">
                                <Border BorderThickness="1,1,1,1" Margin="0,1"
                                    BorderBrush="{StaticResource MenuBorderBrush}" CornerRadius="0"
                                    Background="{StaticResource MenuBackgroundBrush}">
                                    <ScrollViewer x:Name="ScrollViewer" BorderThickness="0" Padding="0" Style="{StaticResource ScrollViewerStyle}">
                                        <ItemsPresenter x:Name="ItemsPresenter"/>
                                    </ScrollViewer>
                                </Border>
                            </Border>
                        </Popup>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!-- The SortButton is the area of the list that denotes the field that is currently used for sorting and 
         the sort direction (ascending or descending)
    -->
    <Style x:Key="SortButtonStyle" TargetType="ctl:SortButton">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="MinHeight" Value="21" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="IsTabStop" Value="True" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Foreground" Value="{StaticResource ListHeaderTextBrush}" />
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ctl:SortButton">
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Fill" Duration="0">
                                            <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextMouseOverBrush}" KeyTime="0"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Foreground" Duration="0">
                                            <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextMouseOverBrush}" KeyTime="0"/>
                                        </ObjectAnimationUsingKeyFrames>

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Fill" Duration="0">
                                            <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextPressedBrush}" KeyTime="0"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Foreground" Duration="0">
                                            <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextPressedBrush}" KeyTime="0"/>
                                        </ObjectAnimationUsingKeyFrames>

                                    </Storyboard>
                                    
                                </VisualState>
                            </VisualStateGroup>

                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="FocusBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0"/>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Fill" Duration="0">
                                            <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextPressedBrush}" KeyTime="0"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Foreground" Duration="0">
                                            <DiscreteObjectKeyFrame Value="{StaticResource ToolbarButtonTextPressedBrush}" KeyTime="0"/>
                                        </ObjectAnimationUsingKeyFrames>

                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />
                            </VisualStateGroup>

                            <VisualStateGroup x:Name="SortStates">
                                <VisualState x:Name="Unsorted" />
                                <VisualState x:Name="SortAscending">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Opacity" Duration="0" To="1.0"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="SortDescending">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="Opacity" Duration="0" To="1.0"/>
                                        <DoubleAnimation Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.Rotation)" Duration="0" To="180"  d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>


                        <Border x:Name="BackgroundRectangle" Margin="0,1,0,4"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{StaticResource ListHeaderBorderBrush}"
                            BorderThickness="0,0,0,0">
                            <Grid>
                                <Border x:Name="FocusBackground" Opacity="0"
                                    BorderThickness="0"/>

                                <Grid
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Margin="{TemplateBinding Padding}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <ContentControl Margin="3,0"
                                                        x:Name="contentPresenter"
                                                        Foreground="{StaticResource NormalFontBrush}"
                                                        Content="{TemplateBinding Content}"
                                                        ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                    <Path x:Name="SortIcon" VerticalAlignment="Center" HorizontalAlignment="Center" Grid.Column="1" RenderTransformOrigin=".5,.5"
                                          Height="3.6849212646484375"
	                                      Width="8"
                                          Stretch="Fill"
                                          Margin="7,1,0,0"
                                          Data="F1 M 301.14,-189.041L 311.57,-189.041L 306.355,-182.942L 301.14,-189.041 Z " UseLayoutRounding="False" 
                                          Fill="#8F897F">
                                        <Path.RenderTransform>
                                            <CompositeTransform/>
                                        </Path.RenderTransform>
                                    </Path>
                                </Grid>

                            </Grid>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <DataTemplate x:Key="SortByTemplate">
        <TextBlock Text="{Binding Converter={StaticResource ToUpperConverter}}" FontSize="13"/>
    </DataTemplate>

    <!-- The Sorting control is the header for the list control.  It shows the field that the list is currently sorted by (the 
         sort button) and the dropdown that allows the users to change the sort by field.-->
    <Style TargetType="ctl:SortingControl">
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ctl:SortingControl">
                    <Grid Margin="1,0,1,0">

                        <!-- Instead of putting these into a grid, the SortButton covers up
                             the SortComboBox so that the Combo can popup its selection inside
                             the list box. Set TabIndex to fix tab order with flipped z-order -->

                        <!-- Field selector combo -->
                        <ctl:SortComboBox
                            x:Name="SortComboBoxElement"
                            AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}:SortByColumnComboBox}"
                            AutomationProperties.Name="{Binding SelectedItem, ElementName=SortComboBoxElement, Converter={StaticResource _SelectedItemToContentConverter}}"
                            AutomationProperties.HelpText="{Binding Description}"
                            ItemsSource="{Binding Converter={StaticResource _ContentItemToPropertiesConverter}}"
                            Style="{StaticResource SortDropDownStyle}"
                            BorderThickness="0"
                            HorizontalAlignment="Right"
                            TabIndex="2"
                            >
                            <ctl:SortComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding DisplayName}" />
                                </DataTemplate>
                            </ctl:SortComboBox.ItemTemplate>
                        </ctl:SortComboBox>

                        <!-- "Sort By: XXX" selector click to reverse accending/decending -->
                        <ctl:SortButton
                            x:Name="SortButtonElement"
                            AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}:SortButton}"
                            AutomationProperties.HelpText="{Binding Description}"
                            Margin="0,0,13,0"
                            TabIndex="1"
                            Content="{Binding SelectedItem, ElementName=SortComboBoxElement, Converter={StaticResource _SelectedItemToContentConverter}}"
                            ContentTemplate="{StaticResource SortByTemplate}"
                            Style="{StaticResource SortButtonStyle}">                            
                        </ctl:SortButton>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Style for the column headers in the data grid -->
    <Style x:Key="DataGridHeaderStyle" TargetType="sdk:DataGridColumnHeader">
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="SeparatorBrush" Value="#FFC9CACA"/>
        <Setter Property="Padding" Value="4,1"/>
        <Setter Property="FontFamily" Value="/PaulozziCo.MetroShell.Client;component/Presentation/Fonts/seguisb.ttf#Segoe UI Semibold" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGridColumnHeader">
                    <Grid x:Name="Root">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0.5" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BackgroundGradient" d:IsOptimized="True"/>
                                        <DoubleAnimation Duration="0" To="0.3" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="VerticalSeparator" d:IsOptimized="True"/>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Grid.Row)" Storyboard.TargetName="SortIcon">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <System:Int32>0</System:Int32>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Grid.Column)" Storyboard.TargetName="SortIcon">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <System:Int32>1</System:Int32>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(FrameworkElement.VerticalAlignment)" Storyboard.TargetName="SortIcon">
                                            <DiscreteObjectKeyFrame KeyTime="0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <VerticalAlignment>Center</VerticalAlignment>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#FFEFEEED" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SortStates">
                                <VisualState x:Name="Unsorted">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="SortIcon" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="SortAscending">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="SortDescending">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                        <DoubleAnimation Storyboard.TargetName="SortIcon" Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.Rotation)" Duration="0" To="180"  d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Rectangle x:Name="BackgroundRectangle" Grid.ColumnSpan="2" Fill="White" Stretch="Fill"/>
                        <Rectangle x:Name="BackgroundGradient" Grid.ColumnSpan="2" Stretch="Fill" Fill="#FFEFEEED" Opacity="0"/>
                        <StackPanel Orientation="Horizontal" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                            <ContentPresenter Content="{TemplateBinding Content}">
                                <ContentPresenter.ContentTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Path=ContentItem.DisplayName, Converter={StaticResource ToUpperConverter}}" 
                                                   HorizontalAlignment="Left"
                                                   Foreground="{TemplateBinding Foreground}"
                                                   d:LayoutOverrides="Height" Margin="6,0,0,0" FontSize="11" />
                                    </DataTemplate>
                                </ContentPresenter.ContentTemplate>
                            </ContentPresenter>

                            <Path x:Name="SortIcon"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Height="3.6849212646484375"
                                Width="8"
                                Stretch="Fill"
                                Opacity="1"
                                  RenderTransformOrigin="0.5,0.5"
                                Data="F1 M 301.14,-189.041L 311.57,-189.041L 306.355,-182.942L 301.14,-189.041 Z "
                                Fill="#8F897F" UseLayoutRounding="False" Grid.Column="1" Margin="7,0,0,0">
                                <Path.RenderTransform>
                                    <CompositeTransform />
                                </Path.RenderTransform>
                            </Path>
                        </StackPanel>
                        <Rectangle x:Name="VerticalSeparator" Grid.Column="1" Visibility="{TemplateBinding SeparatorVisibility}" VerticalAlignment="Stretch" Width="1" Opacity="0" Fill="#FF31302B"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="sdk:DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}"/>

    <Style x:Key="MainDataGridRowStyle" TargetType="sdk:DataGridRow">
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGridRow">
                    <sdk:DataGridFrozenGrid x:Name="Root">
                        <sdk:DataGridFrozenGrid.Resources>
                            <Storyboard x:Key="DetailsVisibleTransition">
                                <DoubleAnimation Duration="00:00:0.1" Storyboard.TargetProperty="ContentHeight" Storyboard.TargetName="DetailsPresenter"/>
                            </Storyboard>
                        </sdk:DataGridFrozenGrid.Resources>
                        <sdk:DataGridFrozenGrid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </sdk:DataGridFrozenGrid.ColumnDefinitions>
                        <sdk:DataGridFrozenGrid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </sdk:DataGridFrozenGrid.RowDefinitions>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="NormalAlternatingRow">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundRectangle"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundRectangle"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NormalSelected">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="RowSelected" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="MouseOverSelected">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="RowSelected" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="UnfocusedSelected">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundRectangle"/>
                                        <ColorAnimation Duration="0" To="#FFE1E7EC" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="UnfocusedEditing"/>
                                <VisualState x:Name="NormalEditing"/>
                                <VisualState x:Name="MouseOverUnfocusedEditing"/>
                                <VisualState x:Name="MouseOverEditing"/>
                                <VisualState x:Name="MouseOverUnfocusedSelected"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ValidationStates">
                                <VisualState x:Name="Valid"/>
                                <VisualState x:Name="Invalid">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Duration="0" Storyboard.TargetProperty="Visibility" Storyboard.TargetName="BackgroundRectangle">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="InvalidVisualElement"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Rectangle x:Name="BackgroundRectangle" Grid.ColumnSpan="2" Fill="#FFEFEEED" Opacity="0" Grid.RowSpan="2"/>
                        <Rectangle x:Name="InvalidVisualElement" Grid.ColumnSpan="2" Fill="#FFF7D8DB" Opacity="0" Grid.RowSpan="2"/>
                        <sdk:DataGridRowHeader x:Name="RowHeader" sdk:DataGridFrozenGrid.IsFrozen="True" Grid.RowSpan="3"/>
                        <sdk:DataGridCellsPresenter x:Name="CellsPresenter" Grid.Column="1" sdk:DataGridFrozenGrid.IsFrozen="True"/>
                        <sdk:DataGridDetailsPresenter x:Name="DetailsPresenter" Grid.Column="1" Grid.Row="1"/>
                        <Rectangle x:Name="BottomGridLine" Grid.Column="1" HorizontalAlignment="Stretch" Height="1" Grid.Row="2"/>
                        <Grid x:Name="RowSelected" Grid.RowSpan="3" HorizontalAlignment="Left" Width="6" Opacity="0">
                            <Grid.Background>
                                <SolidColorBrush Color="#009CC2"/>
                            </Grid.Background>
                        </Grid>
                    </sdk:DataGridFrozenGrid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="DataGridControlRowHeaderStyle" TargetType="sdk:DataGridRowHeader">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="SeparatorBrush" Value="Transparent"/>
        <Setter Property="SeparatorVisibility" Value="Collapsed"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGridRowHeader">
                    <Grid x:Name="Root">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#99D5EAF1" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="EditingRowGlyph"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="MouseOverCurrentRowSelected">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#FFD5EAF1" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="EditingRowGlyph"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NormalCurrentRow">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="EditingRowGlyph"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NormalSelected">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#FFD5EAF1" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="EditingRowGlyph"/>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="NormalEditingRow">
                                    <Storyboard>
                                        <ColorAnimation Duration="0" To="#FFD5EAF1" Storyboard.TargetProperty="(Fill).Color" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="EditingRowGlyph"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ValidationStates">
                                <VisualState x:Name="RowValid"/>
                                <VisualState x:Name="RowInvalid">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundRectangle"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="RowInvalidVisualElement"/>
                                        <ColorAnimation Duration="0" To="#FFDC000C" Storyboard.TargetProperty="(Fill).(GradientStops)[0].Color" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <ColorAnimation Duration="0" To="#FFDC000C" Storyboard.TargetProperty="(Fill).(GradientStops)[1].Color" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <ColorAnimation Duration="0" To="#FFDC000C" Storyboard.TargetProperty="(Fill).(GradientStops)[2].Color" Storyboard.TargetName="CurrentRowGlyph"/>
                                        <ColorAnimation Duration="0" To="#FFDC000C" Storyboard.TargetProperty="(Fill).(GradientStops)[0].Color" Storyboard.TargetName="EditingRowGlyph"/>
                                        <ColorAnimation Duration="0" To="#FFDC000C" Storyboard.TargetProperty="(Fill).(GradientStops)[1].Color" Storyboard.TargetName="EditingRowGlyph"/>
                                        <ColorAnimation Duration="0" To="#FFDC000C" Storyboard.TargetProperty="(Fill).(GradientStops)[2].Color" Storyboard.TargetName="EditingRowGlyph"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Border BorderBrush="#FFFFFFFF" BorderThickness="1,0,1,0" Grid.ColumnSpan="2" Grid.RowSpan="3">
                            <Grid Background="{TemplateBinding Background}">
                                <Rectangle x:Name="RowInvalidVisualElement" Grid.ColumnSpan="2" Fill="#FFF7D8DB" Opacity="0" Grid.RowSpan="3" Stretch="Fill"/>
                                <Rectangle x:Name="BackgroundRectangle" Grid.ColumnSpan="2" Fill="Transparent" Grid.RowSpan="3" Stretch="Fill"/>
                            </Grid>
                        </Border>
                        <Rectangle x:Name="HorizontalSeparator" Grid.ColumnSpan="2" Fill="{TemplateBinding SeparatorBrush}" HorizontalAlignment="Stretch" Height="1" Margin="1,0,1,0" Grid.Row="2" Visibility="{TemplateBinding SeparatorVisibility}"/>
                        <ContentPresenter Content="{TemplateBinding Content}" Grid.Column="1" HorizontalAlignment="Center" Grid.RowSpan="2" VerticalAlignment="Center"/>
                        <Path x:Name="CurrentRowGlyph" Data="F1 M 511.047,352.682L 511.047,342.252L 517.145,347.467L 511.047,352.682 Z " HorizontalAlignment="Center" Height="10" Margin="8,0,8,0" Opacity="0" Grid.RowSpan="2" Stretch="Fill" VerticalAlignment="Center" Width="6">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0,1.75" StartPoint="0,-.15">
                                    <GradientStop Color="#FF84E3FF" Offset="0"/>
                                    <GradientStop Color="#FF6ABFD8" Offset="0.5"/>
                                    <GradientStop Color="#FF5297AB" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                        <Path x:Name="EditingRowGlyph" Data="F1 M 511.047,352.682L 511.047,342.252L 517.145,347.467L 511.047,352.682 Z " HorizontalAlignment="Center" Height="10" Margin="8,0,8,0" Opacity="0" Grid.RowSpan="2" Stretch="Fill" VerticalAlignment="Center" Width="6">
                            <Path.Fill>
                                <LinearGradientBrush EndPoint="0,1.75" StartPoint="0,-.15">
                                    <GradientStop Color="#FF84E3FF" Offset="0"/>
                                    <GradientStop Color="#FF6ABFD8" Offset="0.5"/>
                                    <GradientStop Color="#FF5297AB" Offset="1"/>
                                </LinearGradientBrush>
                            </Path.Fill>
                        </Path>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="MainDataGridCellStyle" TargetType="sdk:DataGridCell">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGridCell">
                    <Grid x:Name="Root" Background="{TemplateBinding Background}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CurrentStates">
                                <VisualState x:Name="Regular"/>
                                <VisualState x:Name="Current">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="FocusVisual"/>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BlueCurrentLine" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ValidationStates">
                                <VisualState x:Name="Valid"/>
                                <VisualState x:Name="Invalid">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="grid" d:IsOptimized="True"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="MouseOver"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="InteractionStates">
                                <VisualState x:Name="Display"/>
                                <VisualState x:Name="Editing"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected"/>
                                <VisualState x:Name="Selected"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Unfocused"/>
                                <VisualState x:Name="Focused"/>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Rectangle x:Name="FocusVisual" HorizontalAlignment="Stretch" IsHitTestVisible="false" Opacity="0" Stroke="{StaticResource ActiveCellOutline}" StrokeThickness="1" VerticalAlignment="Stretch" Fill="{StaticResource ActiveCellBackground}"/>
                        <Rectangle x:Name="BlueCurrentLine" Fill="#66FFFFFF" Stroke="#009CC2" StrokeThickness="1" Width="2" HorizontalAlignment="Left" Margin="0,1" Opacity="0"/>
                        <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        <Rectangle x:Name="InvalidVisualElement" HorizontalAlignment="Stretch" IsHitTestVisible="False" Opacity="0" Stroke="{StaticResource WarningFontBrush}" StrokeThickness="1" VerticalAlignment="Stretch"/>
                        <Rectangle x:Name="RightGridLine" Grid.Column="1" VerticalAlignment="Stretch" Width="1"/>
                        <!-- The following is used to denote that the cell is in an invalid state -->
                        <Grid x:Name="grid" HorizontalAlignment="Left" Width="10" Height="10" Margin="-5,0,0,0" Opacity="0" VerticalAlignment="Center" d:LayoutOverrides="Height">
                            <Ellipse StrokeThickness="0" Fill="{StaticResource ErrorHighlightBrush}"/>
                            <Path
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Height="6"
                                Data="M 1,0 C1,0 0,1 0,1 0,1 2,3 2,3 2,3 0,5 0,5 0,5 1,6 1,6 1,6 3,4 3,4 3,4 5,6 5,6 5,6 6,5 6,5 6,5 4,3 4,3 4,3 6,1 6,1 6,1 5,0 5,0 5,0 3,2 3,2 3,2 1,0 1,0 z"
                                Fill="#ffffff"/>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- The following is the style for the Silverlight DataGrid that is used within the LightSwitch DataGrid.-->
    <Style x:Key="DataGridControlStyle" TargetType="sdk:DataGrid">
        <Setter Property="RowBackground" Value="{StaticResource NormalRowBackground}"/>
        <Setter Property="AlternatingRowBackground" Value="{StaticResource AlternatingRowBackground}"/>
        <Setter Property="GridLinesVisibility" Value="None"/>
        <Setter Property="HorizontalGridLinesBrush" Value="#FFC9CACA"/>
        <Setter Property="VerticalGridLinesBrush" Value="#FFC9CACA"/>
        <Setter Property="IsTabStop" Value="True"/>
        <Setter Property="Background" Value="#FFFFFFFF"/>
        <Setter Property="HeadersVisibility" Value="Column"/>
        <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
        <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="SelectionMode" Value="Extended"/>
        <Setter Property="CanUserReorderColumns" Value="True"/>
        <Setter Property="CanUserResizeColumns" Value="True"/>
        <Setter Property="CanUserSortColumns" Value="True"/>
        <Setter Property="AutoGenerateColumns" Value="False"/>
        <Setter Property="RowDetailsVisibilityMode" Value="VisibleWhenSelected"/>
        <Setter Property="RowHeaderStyle" Value="{StaticResource DataGridControlRowHeaderStyle}"/>
        <Setter Property="RowStyle" Value="{StaticResource MainDataGridRowStyle}"/>
        <Setter Property="ColumnHeaderStyle" Value="{StaticResource DataGridHeaderStyle}"/>
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="DragIndicatorStyle">
            <Setter.Value>
                <Style TargetType="ContentControl">
                    <Setter Property="Foreground" Value="#7FFFFFFF"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ContentControl">
                                <Grid>
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="SortStates">
                                            <VisualState x:Name="Unsorted"/>
                                            <VisualState x:Name="SortAscending">
                                                <Storyboard>
                                                    <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="SortDescending">
                                                <Storyboard>
                                                    <DoubleAnimation Duration="0" To="1.0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SortIcon"/>
                                                    <DoubleAnimation Duration="0" To="-.9" Storyboard.TargetProperty="(RenderTransform).ScaleY" Storyboard.TargetName="SortIcon"/>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Rectangle x:Name="BackgroundRectangle" Grid.ColumnSpan="2" Fill="#66808080" Stretch="Fill"/>
                                    <Rectangle x:Name="BackgroundGradient" Grid.ColumnSpan="2" Opacity="0" Stretch="Fill">
                                        <Rectangle.Fill>
                                            <LinearGradientBrush EndPoint=".7,1" StartPoint=".7,0">
                                                <GradientStop Color="#FFFFFFFF" Offset="0.015"/>
                                                <GradientStop Color="#F9FFFFFF" Offset="0.375"/>
                                                <GradientStop Color="#E5FFFFFF" Offset="0.6"/>
                                                <GradientStop Color="#C6FFFFFF" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                    <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ContentPresenter Content="{TemplateBinding Content}"/>
                                        <Path x:Name="SortIcon" Grid.Column="1" Data="F1 M -5.215,6.099L 5.215,6.099L 0,0L -5.215,6.099 Z " Fill="#7FFFFFFF" HorizontalAlignment="Left" Margin="4,0,0,0" Opacity="0" RenderTransformOrigin=".5,.5" Stretch="Uniform" VerticalAlignment="Center" Width="8">
                                            <Path.RenderTransform>
                                                <ScaleTransform ScaleY=".9" ScaleX=".9"/>
                                            </Path.RenderTransform>
                                        </Path>
                                    </Grid>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="DropLocationIndicatorStyle">
            <Setter.Value>
                <Style TargetType="ContentControl">
                    <Setter Property="Background" Value="#FF3F4346"/>
                    <Setter Property="Width" Value="2"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ContentControl">
                                <Rectangle Fill="{TemplateBinding Background}" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}"/>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="sdk:DataGrid">
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled">
                                    <Storyboard>
                                        <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="DisabledVisualElement"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2">
                            <Grid x:Name="Root" Background="{TemplateBinding Background}">
                                <Grid.Resources>
                                    <ControlTemplate x:Key="TopLeftHeaderTemplate" TargetType="sdk:DataGridColumnHeader">
                                        <Grid x:Name="Root">
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Border BorderThickness="0,0,1,0" Grid.RowSpan="2">
                                                <Rectangle Stretch="Fill" StrokeThickness="1"/>
                                            </Border>
                                            <Rectangle Height="1" Grid.RowSpan="2" StrokeThickness="1" VerticalAlignment="Bottom" Width="Auto"/>
                                        </Grid>
                                    </ControlTemplate>
                                    <ControlTemplate x:Key="TopRightHeaderTemplate" TargetType="sdk:DataGridColumnHeader">
                                        <Grid x:Name="RootElement">
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Border BorderThickness="1,0,0,0" Grid.RowSpan="2">
                                                <Rectangle Stretch="Fill"/>
                                            </Border>
                                        </Grid>
                                    </ControlTemplate>
                                </Grid.Resources>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <sdk:DataGridColumnHeader x:Name="TopLeftCornerHeader" Template="{StaticResource TopLeftHeaderTemplate}" Width="22"/>
                                <sdk:DataGridColumnHeadersPresenter x:Name="ColumnHeadersPresenter" Grid.Column="1"/>
                                <sdk:DataGridColumnHeader x:Name="TopRightCornerHeader" Grid.Column="2" Template="{StaticResource TopRightHeaderTemplate}"/>
                                <sdk:DataGridRowsPresenter x:Name="RowsPresenter" Grid.ColumnSpan="2" Grid.Row="1"/>
                                <ScrollBar x:Name="VerticalScrollbar" Grid.Column="2" Margin="0,-1,-1,-1" Orientation="Vertical" Grid.Row="1" Width="18" Style="{StaticResource MainScrollBarStyle}"/>
                                <Grid Grid.Column="1" Grid.Row="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Rectangle x:Name="FrozenColumnScrollBarSpacer"/>
                                    <ScrollBar x:Name="HorizontalScrollbar" Grid.Column="1" Height="18" Margin="-1,0,-1,-1" Orientation="Horizontal" Style="{StaticResource MainScrollBarStyle}"/>
                                </Grid>
                                <sdk:ValidationSummary x:Name="ValidationSummary" Grid.ColumnSpan="3" MaxHeight="90" Grid.Row="3"/>
                            </Grid>
                        </Border>
                        <Border x:Name="DisabledVisualElement" Background="#8CFFFFFF" CornerRadius="2" HorizontalAlignment="Stretch" Height="Auto" IsHitTestVisible="False" Opacity="0" VerticalAlignment="Stretch" Width="Auto"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="sdk:DataGrid" BasedOn="{StaticResource DataGridControlStyle}"/>
    <ControlTemplate x:Key="ExtendedCommandButtonTemplate" TargetType="Button">
        <Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="NormalIcon" Storyboard.TargetProperty="Visibility" Duration="0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DisabledIcon" Storyboard.TargetProperty="Visibility" Duration="0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Normal"/>
                    <VisualState x:Name="MouseOver">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="NormalIcon" Storyboard.TargetProperty="Visibility" Duration="0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MouseOverIcon" Storyboard.TargetProperty="Visibility" Duration="0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="NormalIcon" Storyboard.TargetProperty="Visibility" Duration="0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MouseOverIcon" Storyboard.TargetProperty="Visibility" Duration="0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Image Stretch="Uniform" Height="16" Width="16" x:Name="NormalIcon"
                Source="{Binding Converter={StaticResource IconConverter}, ConverterParameter=Normal}"
                Visibility="{Binding Path=IsEnabled, Converter={StaticResource BoolToVisibleConverter}}"/>
            <Image Stretch="Uniform" Height="16" Width="16" x:Name="MouseOverIcon"
                Source="{Binding Converter={StaticResource IconConverter}, ConverterParameter=MouseOver}"
                Visibility="Collapsed"/>
            <Image Stretch="Uniform" Height="16" Width="16" x:Name="DisabledIcon"
                Source="{Binding Converter={StaticResource IconConverter}, ConverterParameter=Disabled}"
                Visibility="Collapsed"/>
        </Grid>
    </ControlTemplate>

    <!-- The LightSwitch Data grid visual is an aggregate control that contains a title bar, search box, command toolbar, 
         the actual data grid, and data pager.
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        | Title                                                        |
        | Command Toolbar                           | Search Box       |
        | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
        | DataGrid control                                             |
        |                                                              |
        |                                                              |
        |                                                              |
        |                                                              |
        | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
        | DataPager                                                    |
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    -->
    <Style TargetType="ctl:DataGridVisual">
        <Setter Property="DataGridStyle" Value="{StaticResource DataGridControlStyle}"/>
        <Setter Property="TitleVisibility" Value="Visible"/>
        <Setter Property="CommandVisibility" Value="Visible"/>
        <Setter Property="IsGridMode" Value="True" />
        <Setter Property="CellStyle" Value="{StaticResource MainDataGridCellStyle}" />
        <Setter Property="Template">
            <Setter.Value>
            <ControlTemplate TargetType="ctl:BaseDataGridVisual">
                <ctl:CancellableContentControl
                            AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}:Root}"
                            AutomationProperties.HelpText="{Binding Description}"
                            ExecutableObject="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ExecutableCollection.Loader}">
                    <Border
                                BorderThickness="1" CornerRadius="0"
                                BorderBrush="{StaticResource ListBorderBrush}">
                        <Grid >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition />
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Title -->

                                <Grid Grid.Row="0">
                                    <TextBlock
                                                Visibility="{TemplateBinding TitleVisibility}"
                                                Foreground="{StaticResource ListHeaderTextBrush}"
                                                FontSize="{StaticResource Heading2FontSize}"
                                                FontFamily="{StaticResource Heading2FontFamily}"
                                                Text="{Binding Path=DisplayName, Converter={StaticResource ToLowerConverter}}" 
                                                Margin="5,1" VerticalAlignment="Center" />
                                </Grid>

                                <!-- Command & Search -->
                                <Border
                                        Grid.Row="1"
                                        Background="{StaticResource ToolbarBackgroundBrush}"
                                        BorderThickness="0,0,0,1"
                                        BorderBrush="{StaticResource ToolbarSeparatorBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="2000*" MaxWidth="165"/>
                                        </Grid.ColumnDefinitions>
                                        <framework:CommandGroupPresenter
                                                x:Name="CommandGroupPresenterElement"
                                                Visibility="{TemplateBinding CommandVisibility}"
                                                Commands="{Binding CommandItems}"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Margin="3,2"
                                                TabIndex="1"
                                                ContainerState="IntegratedCommandGroup"
                                                />
                                        <Rectangle Grid.Column="1"
                                                Visibility="{TemplateBinding CommandSeparatorVisible}"
                                                Fill="{StaticResource ToolbarSeparatorBrush}" VerticalAlignment="Stretch" Width="1"
                                                Margin="0,3"/>
                                        <!-- The following is used to display the ExportToExcel command, as appropriate -->
                                        <ItemsControl x:Name="ExtendedCommandsPreseterElement"
                                                          ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ExtendedCommands}" IsTabStop="False"
                                                          Grid.Column="2" Visibility="{TemplateBinding ExtendedCommandVisible}" TabIndex="2">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Horizontal" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Button
                                                            AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}}"
                                                            AutomationProperties.Name="{Binding DisplayName}"
                                                            AutomationProperties.HelpText="{Binding Description}"
                                                            Command="{Binding}"
                                                            HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            ToolTipService.ToolTip="{Binding Path=Description}"
                                                            Margin="3,3,3,1"
                                                            Style="{StaticResource CollectionButtonStyle}"
															Template="{StaticResource ExtendedCommandButtonTemplate}"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        <ctl:ListSearchControl
                                                AutomationProperties.AutomationId="{Binding DisplayName, StringFormat=Control:\{0\}:SearchBox}"
                                                AutomationProperties.Name="{Binding DisplayName}"
                                                AutomationProperties.HelpText="{Binding Description}"
                                                Grid.Column="4"
                                                Visibility="{TemplateBinding SearchingVisibility}"
                                                ExecutableCollection="{TemplateBinding ExecutableCollection}"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Stretch"
                                                ShowCancelAndProgress="False"
                                                Background="{StaticResource TextBoxBackgroundBrush}"
                                                MinHeight="22"
                                                Margin="5"
                                                TabIndex="3"
                                                />
                                    </Grid>
                                </Border>
                                <!-- Pager -->
                                <Border
                                        Grid.Row="3"
                                        Visibility="{TemplateBinding PagerVisibility}"
                                        Background="{StaticResource ToolbarBackgroundBrush}"
                                        BorderThickness="0,1,0,0"
                                        BorderBrush="{StaticResource ToolbarSeparatorBrush}"
                                        HorizontalAlignment="Stretch" >
                                
                                    <sdk:DataPager
                                            Source="{TemplateBinding CollectionView}"
                                            BorderThickness="0"
                                            DisplayMode="PreviousNextNumeric"
                                            Background="Transparent"
                                            Foreground="{StaticResource ToolbarButtonTextBrush}"
                                            HorizontalAlignment="Left"
                                            IsTabStop="False"
                                            IsTotalItemCountFixed="True"
                                            Style="{StaticResource DataPagerStyle}"
                                            />
                                </Border>

                            <Grid Grid.Row="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Border
                                            Visibility="{TemplateBinding SortControlVisibility}"
                                            BorderThickness="0,0,0,0"
                                            Background="{StaticResource ListHeaderBackgroundBrush}"
                                            >
                                    <ctl:SortingControl
                                                Visibility="{TemplateBinding SortingVisibility}"
                                                CollectionView="{TemplateBinding CollectionView}"
                                                ExecutableCollection="{TemplateBinding ExecutableCollection}"
                                                Margin="0,0,0,-1"
                                                TabIndex="4"
                                                />
                                </Border>
                                <Border Grid.Row="1"
                                            BorderThickness="0,0,0,1"
                                            VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                                            Background="{StaticResource ToolbarBackgroundBrush}">
                                    <ctl:BaseDataGridControl
                                                    x:Name="DataGridControlElement"
                                                    AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}:DataGrid}"
                                                    AutomationProperties.Name="{Binding DisplayName}"
                                                    AutomationProperties.HelpText="{Binding Description}"
                                                    CanUserSortColumns="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SortingVisibility, Converter={StaticResource VisibilityToBooleanConverter}}"
                                                    CollectionVisual="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                                    ItemsSource="{TemplateBinding CollectionView}"
                                                    SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedItem, Mode=TwoWay}"
                                                    Style="{TemplateBinding DataGridStyle}"
                                                    TabNavigation="Local"
                                                    IsEmptySelectionAllowed="True"
                                                    IsGridMode="{TemplateBinding IsGridMode}"
                                                    TabIndex="5"
                                                    />
                                </Border>
                            </Grid>
                        </Grid>
                    </Border>
                </ctl:CancellableContentControl>
            </ControlTemplate>
        </Setter.Value>
        </Setter>
    </Style>

    <!-- The LightSwitch list visual, like the data grid, is an aggregate control that contains a title bar, search box, 
         command toolbar, sort header, a single-column data grid, and data pager.
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        | Title                                                        |
        | Command Toolbar                           | Search Box       |
        | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
        | SortBy  v                                                    |
        | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
        | DataGrid control                                             |
        |                                                              |
        |                                                              |
        |                                                              |
        |                                                              |
        | ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
        | DataPager                                                    |
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    -->
    <Style TargetType="ctl:ListVisual">
        <Setter Property="DataGridStyle" Value="{StaticResource DataGridControlStyle}"/>
        <Setter Property="TitleVisibility" Value="Visible"/>
        <Setter Property="CommandVisibility" Value="Visible"/>
        <Setter Property="IsGridMode" Value="True" />
        <Setter Property="CellStyle" Value="{StaticResource MainDataGridCellStyle}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ctl:ListVisual">
                    <ctl:CancellableContentControl
                            AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}:Root}"
                            AutomationProperties.HelpText="{Binding Description}"
                            ExecutableObject="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ExecutableCollection.Loader}">
                        <Border
                                BorderThickness="1" CornerRadius="0"
                                BorderBrush="{StaticResource ListBorderBrush}">
                            <Grid >
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition />
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Title -->
                                <Grid Grid.Row="0">
                                    <TextBlock
                                                Visibility="{TemplateBinding TitleVisibility}"
                                                Foreground="{StaticResource ListHeaderTextBrush}"
                                                FontSize="{StaticResource Heading2FontSize}"
                                                FontFamily="{StaticResource Heading2FontFamily}"
                                                Text="{Binding Path=DisplayName, Converter={StaticResource ToLowerConverter}}" 
                                                Margin="6,1" VerticalAlignment="Center"
                                                />

                                </Grid>
                                <!-- Command & Search -->
                                <Border
                                        Grid.Row="1"
                                        Background="{StaticResource ToolbarBackgroundBrush}"
                                        BorderThickness="0,0,0,1"
                                        BorderBrush="{StaticResource ToolbarSeparatorBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="2000*" MaxWidth="165"/>
                                        </Grid.ColumnDefinitions>
                                        <!-- Built-in commands are displayed here.-->
                                        <framework:CommandGroupPresenter
                                                x:Name="CommandGroupPresenterElement"
                                                Visibility="{TemplateBinding CommandVisibility}"
                                                Commands="{Binding CommandItems}"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center"
                                                Margin="3,2"
                                                TabIndex="1"
                                                ContainerState="IntegratedCommandGroup"
                                                />
                                        <Rectangle Grid.Column="1"
                                                Visibility="{TemplateBinding CommandSeparatorVisible}"
                                                Fill="{StaticResource ToolbarSeparatorBrush}" VerticalAlignment="Stretch" Width="1"
                                                Margin="0,3"/>
                                        <!-- The ExportToExcel command is displayed here -->
                                        <ItemsControl x:Name="ExtendedCommandsPreseterElement"
                                                          ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ExtendedCommands}" IsTabStop="False"
                                                          Grid.Column="2" Visibility="{TemplateBinding ExtendedCommandVisible}" TabIndex="2">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Horizontal" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Button
                                                            AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}}"
                                                            AutomationProperties.Name="{Binding DisplayName}"
                                                            AutomationProperties.HelpText="{Binding Description}"
                                                            Command="{Binding}"
                                                            HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            ToolTipService.ToolTip="{Binding Path=Description}"
                                                            Margin="3,2"
                                                            Style="{StaticResource CollectionButtonStyle}"
															Template="{StaticResource ExtendedCommandButtonTemplate}"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                        <ctl:ListSearchControl
                                                AutomationProperties.AutomationId="{Binding DisplayName, StringFormat=Control:\{0\}:SearchBox}"
                                                AutomationProperties.Name="{Binding DisplayName}"
                                                AutomationProperties.HelpText="{Binding Description}"
                                                Grid.Column="4"
                                                Visibility="{TemplateBinding SearchingVisibility}"
                                                ExecutableCollection="{TemplateBinding ExecutableCollection}"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Stretch"
                                                ShowCancelAndProgress="False"
                                                Background="{StaticResource TextBoxBackgroundBrush}"
                                                MinHeight="22"
                                                Margin="5"
                                                TabIndex="3"
                                                >

                                        </ctl:ListSearchControl>
                                    </Grid>
                                </Border>
                                <!-- Pager -->
                                <Border
                                        Grid.Row="3"
                                        Visibility="{TemplateBinding PagerVisibility}"
                                        Background="{StaticResource ToolbarBackgroundBrush}"
                                        BorderThickness="0,1,0,0"
                                        BorderBrush="{StaticResource ToolbarSeparatorBrush}"
                                        HorizontalAlignment="Stretch" >

                                    <sdk:DataPager
                                            Source="{TemplateBinding CollectionView}"
                                            BorderThickness="0"
                                            DisplayMode="PreviousNextNumeric"
                                            Background="Transparent"
                                            Foreground="{StaticResource ToolbarButtonTextBrush}"
                                            HorizontalAlignment="Left"
                                            IsTabStop="False"
                                            IsTotalItemCountFixed="True"
                                            Style="{StaticResource DataPagerStyle}"
                                            />
                                </Border>

                                <Grid Grid.Row="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                            Visibility="{TemplateBinding SortControlVisibility}"
                                            BorderThickness="0,0,0,0"
                                            Background="{StaticResource ListHeaderBackgroundBrush}"
                                            >
                                        <ctl:SortingControl
                                                Visibility="{TemplateBinding SortingVisibility}"
                                                CollectionView="{TemplateBinding CollectionView}"
                                                ExecutableCollection="{TemplateBinding ExecutableCollection}"
                                                Margin="0,0,0,-1"
                                                TabIndex="4"
                                                />
                                    </Border>
                                    <Border Grid.Row="1"
                                            BorderThickness="0,0,0,1"
                                            VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                                            Background="{StaticResource ToolbarBackgroundBrush}">
                                        <ctl:BaseDataGridControl
                                                    x:Name="DataGridControlElement"
                                                    AutomationProperties.AutomationId="{Binding Name, StringFormat=Control:\{0\}:DataGrid}"
                                                    AutomationProperties.Name="{Binding DisplayName}"
                                                    AutomationProperties.HelpText="{Binding Description}"
                                                    CanUserSortColumns="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SortingVisibility, Converter={StaticResource VisibilityToBooleanConverter}}"
                                                    CollectionVisual="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                                    ItemsSource="{TemplateBinding CollectionView}"
                                                    SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedItem, Mode=TwoWay}"
                                                    Style="{TemplateBinding DataGridStyle}"
                                                    TabNavigation="Local"
                                                    IsEmptySelectionAllowed="True"
                                                    IsGridMode="{TemplateBinding IsGridMode}"
                                                    TabIndex="5"
                                                    />
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </ctl:CancellableContentControl>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- The list style that is used in the modal window picker-->
    <Style x:Key="PickerListControlStyle" TargetType="sdk:DataGrid" BasedOn="{StaticResource DataGridControlStyle}">
        <Setter Property="GridLinesVisibility" Value="All"/>
        <Setter Property="HeadersVisibility" Value="None"/>
        <Setter Property="AlternatingRowBackground" Value="Transparent"/>
        <Setter Property="IsReadOnly" Value="True"/>
    </Style>

</ResourceDictionary>
